import Link from "next/link";
import cn from "clsx";
import { useState } from "react";
import { motion } from "framer-motion";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faDownload, faCode } from "@fortawesome/free-solid-svg-icons";
import { faGithub } from "@fortawesome/free-brands-svg-icons";
import { useSSG } from "nextra/ssg";
import Date from "../components/Date";
import { Card, Cards } from "../components/Card/";

import { Features, Feature } from "../components/Features";

<div className="home-content">
  <div className="content-container">
    <h1 className="headline">Downloads</h1>
    <p className="subtitle">Welcome to the FOSSBilling Download Page! ðŸŽ‰ <br />    We're excited to have you here! We are on the journey towards the release of version 1.0.0, and we're working hard to make FOSSBilling ready for production use.<br /><br />Please bear in mind a few key points as you consider downloading:</p>
    <p className="subtitle">- FOSSBilling is in its dynamic pre-production phase, which means some features are still under development.<br />- We suggest having some level of technical knowledge or a willingness to learn, so you can make the most out of FOSSBilling.<br />- Before updating, kindly review the release notes to familiarize yourself with the new and improved features.<br />- Knowing a bit about PHP and software development could be beneficial, not only to contribute to FOSSBilling's growth but also to troubleshoot any issues you might encounter.</p>
    <h3 className="headline">Let's Grow Together! ðŸŒ±</h3>
    <p className="subtitle">We genuinely believe in the potential of FOSSBilling and are thrilled about the community around it. Any support, be it through contributions, feedback, or donations, can significantly accelerate our journey towards the release of FOSSBilling 1.0.0! Your generosity helps fuel development and brings us closer to realizing our vision.</p>
    <p className="subtitle">If you find value in what we are building and would like to support us, please consider [becoming a sponsor](https://opencollective.com/FOSSBilling). <br /> Every bit helps, and we are grateful for your support.</p>
  </div>
  <div className="features-container">
    <div className="content-container">
      <Features>
        <Feature large centered>
            <h3>Releases <br className="show-on-mobile"/>(v<LatestVersion />)</h3>
            <h4>Released on <ReleasedOn /></h4>
            <p>Download the latest release of FOSSBilling. This is the recommended choice for all users.
            System requirements:</p>
            <ul>
              <li> - A suitable web server</li>
              <li> - PHP 8.0+</li>
              <li> - MySQL 8+ or MariaDB 10.3+</li>
            </ul>
            <div className='mt-4 gap-4 flex justify-center'>
                <Card icon={<FontAwesomeIcon icon={faDownload} size="xl" />} title="Download now" href="/downloads/stable"/>
            </div>
        </Feature>
        <Feature centered>
            <h3><FontAwesomeIcon icon={ faCode } /> Preview builds</h3>
            <p>If you are a developer, you might want to use this build instead. Preview builds are automatically generated from the main branch after each commit.</p>
            <div className='mt-4 gap-4 flex justify-center'>
                <Card icon={<FontAwesomeIcon icon={faDownload} size="xl" />} title="Download now" href="/downloads/preview"/>
            </div>
        </Feature>
      </Features>
    </div>
  </div>
  <div className="home-content">
    <div className="content-container">
      <h3 classname="headline">Ready to Dive In? ðŸš€</h3>
      <p className="subtitle">Feel free to explore, experiment, and let us know what you think. We're here to help, learn, and grow together in making FOSSBilling the best it can be. Your engagement and insights are invaluable in bringing this project to life.<br /> Thank you for being part of our exciting journey. Let's create something amazing together!</p>
    </div>
  </div>
</div>

export const getStaticProps = ({ params }) => {
  return fetch(`https://api.github.com/repos/FOSSBilling/FOSSBilling/releases`)
    .then(res => res.json())
    .then(releases => ({
      props: {
        // We add an `ssg` field to the page props,
        // which will be provided to the Nextra `useSSG` hook.
        ssg: {
          latest_version: releases[0].tag_name,
          released_on: releases[0].published_at,
        }
      },
      // The page will be considered as stale and regenerated every 10 minutes. Release data is not updated that often, so 10 minutes should be fine.
      revalidate: 600
    }))
}
 
export const LatestVersion = () => {
  // Get the data from SSG, and render it as a component.
  const { latest_version } = useSSG()
  return <>{ latest_version }</>
}

export const ReleasedOn = () => {
  // Get the data from SSG, and render it as a component.
  const { released_on } = useSSG()
  return <Date dateString={released_on} />

}
