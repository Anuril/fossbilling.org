import Link from "next/link";
import cn from "clsx";
import { useState } from "react";
import { motion } from "framer-motion";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faDownload, faCode } from "@fortawesome/free-solid-svg-icons";
import { faGithub } from "@fortawesome/free-brands-svg-icons";
import { useSSG } from "nextra/ssg";
import Date from "../components/Date";
import { Card, Cards } from "../components/Card/";

import { Features, Feature } from "../components/Features";

<div className="home-content">
  <div className="content-container">
    <h1 className="headline">Downloads</h1>
    <p className="subtitle">Welcome to the FOSSBilling Download Page! ðŸš€<br />
    Weâ€™re striving to launch FOSSBilling 1.0.0 and weâ€™re eager to have you join our journey! Keep in mind, FOSSBilling is in a vibrant pre-production stage, so some prowess or willingness to learn will help you make the most out of it.<br /><br />
    Before diving in, please review the release notes for any updates and consider some familiarity with PHP and software development to be advantageous. Itâ€™ll allow you to contribute and navigate through any hiccups you might face.<br /><br />
    <b>Let's Make It Happen Together! ðŸŒŸ</b><br />
    FOSSBilling has immense potential, and with your support, through feedback, contributions and [donations](https://opencollective.com/FOSSBilling), we can accelerate its development and bring FOSSBilling 1.0.0 to life sooner! Every bit of support counts and brings us closer to our shared vision.<br /><br />
    <b>Ready to Join the Adventure?</b><br />
    Dive in, explore, and be a part of our exciting journey to shape FOSSBilling. Your engagement is the key to making this project phenomenal! Thank you for your support and belief in FOSSBilling!</p>

  </div>
  <div className="features-container">
    <div className="content-container">
      <Features>
        <Feature large centered>
            <h3>Releases <br className="show-on-mobile"/>(v<LatestVersion />)</h3>
            <h4>Released on <ReleasedOn /></h4>
            <p>Download the latest release of FOSSBilling. This is the recommended choice for all users.
            System requirements:</p>
            <ul>
              <li> - A suitable web server</li>
              <li> - PHP 8.0+</li>
              <li> - MySQL 8+ or MariaDB 10.3+</li>
            </ul>
            <div className='mt-4 gap-4 flex justify-center'>
                <Card icon={<FontAwesomeIcon icon={faDownload} size="xl" />} title="Download now" href="/downloads/stable"/>
            </div>
        </Feature>
        <Feature centered>
            <h3><FontAwesomeIcon icon={ faCode } /> Preview builds</h3>
            <p>If you are a developer, you might want to use this build instead. Preview builds are automatically generated from the main branch after each commit.</p>
            <div className='mt-4 gap-4 flex justify-center'>
                <Card icon={<FontAwesomeIcon icon={faDownload} size="xl" />} title="Download now" href="/downloads/preview"/>
            </div>
        </Feature>
      </Features>
    </div>
  </div>
  <div className="content-container">
    <h3 classname="headlineSmall">Ready to Dive In? ðŸš€</h3>
    <p className="subtitle">Feel free to explore, experiment, and let us know what you think. We're here to help, learn, and grow together in making FOSSBilling the best it can be. Your engagement and insights are invaluable in bringing this project to life.<br /> Thank you for being part of our exciting journey. Let's create something amazing together!</p>
  </div>
</div>

export const getStaticProps = ({ params }) => {
  return fetch(`https://api.github.com/repos/FOSSBilling/FOSSBilling/releases`)
    .then(res => res.json())
    .then(releases => ({
      props: {
        // We add an `ssg` field to the page props,
        // which will be provided to the Nextra `useSSG` hook.
        ssg: {
          latest_version: releases[0].tag_name,
          released_on: releases[0].published_at,
        }
      },
      // The page will be considered as stale and regenerated every 10 minutes. Release data is not updated that often, so 10 minutes should be fine.
      revalidate: 600
    }))
}
 
export const LatestVersion = () => {
  // Get the data from SSG, and render it as a component.
  const { latest_version } = useSSG()
  return <>{ latest_version }</>
}

export const ReleasedOn = () => {
  // Get the data from SSG, and render it as a component.
  const { released_on } = useSSG()
  return <Date dateString={released_on} />

}
